{"ast":null,"code":"var _jsxFileName = \"/Users/noah.menikefs/Desktop/menisked/MeniSked/src/Components/Messages/EMessages.js\";\nimport React from 'react';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Button from 'react-bootstrap/Button';\nimport Modal from 'react-bootstrap/Modal';\nimport moment from 'moment';\nimport './Messages.css';\n\nclass EMessages extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {\n      this.loadMessages();\n      this.loadEntries();\n      this.loadCallTypes();\n    };\n\n    this.loadMessages = () => {\n      fetch('http://localhost:3000/emessages/' + this.props.user.id).then(response => response.json()).then(messages => this.setState({\n        messages: messages.filter(message => message.status !== 'pending')\n      }));\n    };\n\n    this.loadEntries = () => {\n      fetch('http://localhost:3000/sked/entries').then(response => response.json()).then(entries => this.setState({\n        entryList: entries\n      }));\n    };\n\n    this.loadCallTypes = () => {\n      fetch('http://localhost:3000/callTypes').then(response => response.json()).then(calls => this.setState({\n        callList: calls\n      }));\n    };\n\n    this.loadActiveDocs = () => {\n      fetch('http://localhost:3000/sked/docs').then(response => response.json()).then(docs => this.setState({\n        activeDocs: docs\n      }));\n    };\n\n    this.months = moment.months();\n\n    this.toggleShow = route => {\n      this.setState({\n        show: !this.state.show,\n        msg: route\n      });\n    };\n\n    this.showMore = () => {\n      this.setState({\n        ctr: this.state.ctr + 10\n      });\n    };\n\n    this.showButton = length => {\n      if (this.state.ctr < length) {\n        return /*#__PURE__*/React.createElement(Button, {\n          onClick: this.showMore,\n          className: \"showMore\",\n          variant: \"primary\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 12\n          }\n        }, \"Show More\");\n      }\n    };\n\n    this.entryIdToName = id => {\n      id = parseInt(id, 10);\n      const arr = [...this.state.entryList, ...this.state.callList];\n\n      for (let i = 0; i < arr.length; i++) {\n        if (id === arr[i].id) {\n          return arr[i].name;\n        }\n      }\n    };\n\n    this.dateStyler = dates => {\n      let splitArr = [];\n      let flag = false;\n\n      if (dates.length === 1) {\n        splitArr = dates[0].split('/');\n        return 'on ' + this.months[splitArr[0] - 1] + ' ' + splitArr[1] + ', ' + splitArr[2];\n      }\n\n      for (let i = 0; i < dates.length; i++) {\n        if (dates[i].charAt(4) === '/') {\n          dates[i] = dates[i].substring(0, 3) + '0' + dates[i].substring(3);\n        }\n      }\n\n      dates.sort(function (a, b) {\n        return a.substring(3, 5) - b.substring(3, 5);\n      });\n\n      for (let i = 0; i < dates.length; i++) {\n        splitArr.push(dates[i].split('/'));\n      }\n\n      for (let n = 1; n < splitArr.length; n++) {\n        if (splitArr[n][0] !== splitArr[n - 1][0] || splitArr[n][1] - 1 !== parseInt(splitArr[n - 1][1], 10) || splitArr[n][2] !== splitArr[n - 1][2]) {\n          flag = true;\n          break;\n        }\n      }\n\n      if (flag) {\n        let str = \"on \" + this.months[splitArr[0][0] - 1] + ' ' + splitArr[0][1] + ', ' + splitArr[0][2];\n\n        for (let j = 1; j < splitArr.length; j++) {\n          str = str + ', ' + this.months[splitArr[j][0] - 1] + ' ' + splitArr[j][1] + ', ' + splitArr[j][2];\n        }\n\n        return str;\n      }\n\n      return 'from ' + this.months[splitArr[0][0] - 1] + ' ' + splitArr[0][1] + ', ' + splitArr[0][2] + ' - ' + this.months[splitArr[splitArr.length - 1][0] - 1] + ' ' + splitArr[splitArr.length - 1][1] + ', ' + splitArr[splitArr.length - 1][2];\n    };\n\n    this.sortDates = arr => {\n      let list = [...arr];\n      let index = 0;\n      let currDate = [];\n      let newDate = [];\n      let temp;\n      let len = list.length;\n      let flag = false;\n\n      for (let i = 0; i < len - 1; i++) {\n        index = i;\n        currDate = list[i].stamp.split('/');\n\n        for (let j = i + 1; j < len; j++) {\n          flag = false;\n          newDate = list[j].stamp.split('/');\n\n          if (parseInt(newDate[2], 10) > parseInt(currDate[2], 10)) {\n            flag = true;\n          } else if (parseInt(newDate[2], 10) === parseInt(currDate[2], 10)) {\n            if (parseInt(newDate[0], 10) > parseInt(currDate[0], 10)) {\n              flag = true;\n            } else if (parseInt(newDate[0], 10) === parseInt(currDate[0], 10) && parseInt(newDate[1], 10) > parseInt(currDate[1], 10)) {\n              flag = true;\n            }\n          }\n\n          if (flag) {\n            index = j;\n            currDate = list[j].stamp.split('/');\n          }\n        }\n\n        if (index !== i) {\n          temp = list[i];\n          list[i] = list[index];\n          list[index] = temp;\n        }\n      }\n\n      return list;\n    };\n\n    this.state = {\n      show: false,\n      msg: '',\n      messages: [],\n      entryList: [],\n      callList: [],\n      ctr: 10,\n      activeDocs: [],\n      selectIndex: 0\n    };\n  }\n\n  render() {\n    const {\n      show,\n      msg,\n      messages,\n      ctr,\n      activeDocs,\n      selectIndex\n    } = this.state;\n    let msgs = [...messages];\n    msgs = this.sortDates(msgs);\n    let msgList = [];\n\n    for (let j = 0; j < Math.min(msgs.length, ctr); j++) {\n      if (msgs[j].status === 'accepted') {\n        msgList.push( /*#__PURE__*/React.createElement(ListGroup, {\n          key: j,\n          horizontal: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 6\n          }\n        }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n          className: \"pend list\",\n          action: true,\n          disabled: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 7\n          }\n        }, \"Peter Menikefs \", /*#__PURE__*/React.createElement(\"span\", {\n          className: msgs[j].status,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 76\n          }\n        }, msgs[j].status), \" your request for \", this.entryIdToName(msgs[j].entryid), \" \", this.dateStyler(msgs[j].dates)), /*#__PURE__*/React.createElement(ListGroup.Item, {\n          className: \"edates list\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 7\n          }\n        }, msgs[j].stamp)));\n      } else {\n        msgList.push( /*#__PURE__*/React.createElement(ListGroup, {\n          key: j,\n          horizontal: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 6\n          }\n        }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n          className: \"pend list\",\n          action: true,\n          onClick: () => this.toggleShow(msgs[j].msg),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 7\n          }\n        }, \"Peter Menikefs \", /*#__PURE__*/React.createElement(\"span\", {\n          className: msgs[j].status,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 112\n          }\n        }, msgs[j].status), \" your request for \", this.entryIdToName(msgs[j].entryid), \" \", this.dateStyler(msgs[j].dates)), /*#__PURE__*/React.createElement(ListGroup.Item, {\n          className: \"edates list\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 7\n          }\n        }, msgs[j].stamp)));\n      }\n    }\n\n    let docSelect = activeDocs.map((doc, i) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: i,\n        value: doc.lastname,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }\n      }, doc.lastname);\n    });\n    docSelect.unshift( /*#__PURE__*/React.createElement(\"option\", {\n      key: -1,\n      value: \"All\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 21\n      }\n    }, \"All\"));\n\n    let adminSelect = () => {\n      return /*#__PURE__*/React.createElement(\"select\", {\n        value: activeDocs[selectIndex].lastname,\n        onChange: this.onPhysicianChange,\n        className: \"top-child doc selector\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 5\n        }\n      }, docSelect);\n    };\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"listStyleE\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 5\n      }\n    }, msgList), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 5\n      }\n    }, this.showButton(messages.length)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(Modal, {\n      show: show,\n      onHide: () => this.toggleShow(''),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(Modal.Header, {\n      closeButton: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Modal.Title, {\n      id: \"modalTitle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 8\n      }\n    }, \"Denied Request Explanation\")), /*#__PURE__*/React.createElement(Modal.Body, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 8\n      }\n    }, msg)), /*#__PURE__*/React.createElement(Modal.Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      onClick: () => this.toggleShow(''),\n      variant: \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 8\n      }\n    }, \"Close\")))));\n  }\n\n}\n\nexport default EMessages;","map":{"version":3,"sources":["/Users/noah.menikefs/Desktop/menisked/MeniSked/src/Components/Messages/EMessages.js"],"names":["React","ListGroup","Button","Modal","moment","EMessages","Component","constructor","props","componentDidMount","loadMessages","loadEntries","loadCallTypes","fetch","user","id","then","response","json","messages","setState","filter","message","status","entries","entryList","calls","callList","loadActiveDocs","docs","activeDocs","months","toggleShow","route","show","state","msg","showMore","ctr","showButton","length","entryIdToName","parseInt","arr","i","name","dateStyler","dates","splitArr","flag","split","charAt","substring","sort","a","b","push","n","str","j","sortDates","list","index","currDate","newDate","temp","len","stamp","selectIndex","render","msgs","msgList","Math","min","entryid","docSelect","map","doc","lastname","unshift","adminSelect","onPhysicianChange"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Button from 'react-bootstrap/Button'\nimport Modal from 'react-bootstrap/Modal';\nimport moment from 'moment';\nimport './Messages.css';\n\nclass EMessages extends React.Component{\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tshow: false,\n\t\t\tmsg: '',\n\t\t\tmessages: [],\n\t\t\tentryList: [],\n\t\t\tcallList: [],\n\t\t\tctr: 10,\n\t\t\tactiveDocs: [],\n\t\t\tselectIndex: 0\n\t\t}\n\t}\n\n\tcomponentDidMount = () => {\n\t\tthis.loadMessages();\n\t\tthis.loadEntries();\n\t\tthis.loadCallTypes();\n\t}\n\n\tloadMessages = () => {\n\t\tfetch('http://localhost:3000/emessages/'+this.props.user.id)\n      \t\t.then(response => response.json())\n      \t\t.then(messages => this.setState({messages: messages.filter((message => message.status !== 'pending'))}));\n\t}\n\n\tloadEntries = () => {\n\t\tfetch('http://localhost:3000/sked/entries')\n\t\t\t.then(response => response.json())\n\t\t\t.then(entries => this.setState({entryList: entries}));\n\t}\n\n\tloadCallTypes = () => {\n\t\tfetch('http://localhost:3000/callTypes')\n\t\t\t.then(response => response.json())\n\t\t\t.then(calls => this.setState({callList: calls}));\n\t}\n\n\tloadActiveDocs = () => {\n    \tfetch('http://localhost:3000/sked/docs')\n      \t\t.then(response => response.json())\n      \t\t.then(docs => this.setState({activeDocs: docs}));\n\n  \t}\n\n\tmonths = moment.months(); // List of each month\n\n\ttoggleShow = (route) => {\n\t    this.setState({ \n\t\t\tshow: !this.state.show,\n\t\t    msg: route\n\t   \t});\n\t };\n\n\tshowMore = () => {\n\t\tthis.setState({ctr: this.state.ctr+10})\n\t}\n\n\tshowButton = (length) => {\n\t\tif (this.state.ctr < length){\n\t\t\treturn (<Button onClick={this.showMore} className='showMore' variant=\"primary\">Show More</Button>);\n\t\t}\n\t}\n\n\tentryIdToName = (id) => {\n\t\tid = parseInt(id,10);\n\t\tconst arr = [...this.state.entryList, ...this.state.callList]\n\t\tfor (let i = 0; i < arr.length; i++){\n\t\t\tif (id === arr[i].id){\n\t\t\t\treturn arr[i].name;\n\t\t\t}\n\t\t}\n\t}\n\n\tdateStyler = (dates) => {\n\t\tlet splitArr = [];\n\t\tlet flag = false;\n\t\tif (dates.length === 1){\n\t\t\tsplitArr = dates[0].split('/');\n\t\t\treturn 'on ' + this.months[splitArr[0] - 1] + ' ' + splitArr[1] + ', ' + splitArr[2];\n\t\t}\n\n\t\tfor (let i = 0; i < dates.length; i++){\n\t\t\tif (dates[i].charAt(4) === '/'){\n\t\t\t\tdates[i] = dates[i].substring(0,3) + '0' + dates[i].substring(3);\n\t\t\t}\n\t\t}\n\n\t\tdates.sort(function(a, b){return a.substring(3,5) - b.substring(3,5)})\n\n\t\tfor (let i = 0; i < dates.length; i++){\n\t\t\tsplitArr.push(dates[i].split('/'));\n\t\t}\n\n\n\t\tfor (let n = 1; n < splitArr.length; n++){\n\t\t\tif (splitArr[n][0] !== splitArr[n-1][0] || (splitArr[n][1] - 1) !== parseInt(splitArr[n-1][1],10) || splitArr[n][2] !== splitArr[n-1][2]){\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (flag){\n\t\t\tlet str = \"on \" + this.months[splitArr[0][0] - 1] + ' ' + splitArr[0][1] + ', ' + splitArr[0][2];\n\t\t\tfor (let j = 1; j < splitArr.length; j++){\n\t\t\t\tstr = str + ', ' + this.months[splitArr[j][0] - 1] + ' ' + splitArr[j][1] + ', ' + splitArr[j][2];\n\t\t\t}\n\t\t\treturn str;\n\t\t}\n\n\t\treturn 'from ' + this.months[splitArr[0][0] - 1] + ' ' + splitArr[0][1] + ', ' + splitArr[0][2] + ' - ' + this.months[splitArr[splitArr.length - 1][0] - 1] + ' ' + splitArr[splitArr.length - 1][1] + ', ' + splitArr[splitArr.length - 1][2]\n\t\n\t}\n\n\tsortDates = (arr) => {\n\t\tlet list = [...arr];\n\t\tlet index = 0;\n\t\tlet currDate = [];\n\t\tlet newDate = [];\n\t\tlet temp;\n\t\tlet len = list.length;\n\t\tlet flag = false;\n\n\t\tfor (let i = 0; i < len - 1; i++){\n\t\t\tindex = i;\n\t\t\tcurrDate = list[i].stamp.split('/');\n\t\t\tfor (let j = i+1; j < len; j++){\n\t\t\t\tflag = false;\n\t\t\t\tnewDate = list[j].stamp.split('/');\n\t\t\t\tif (parseInt(newDate[2],10) > parseInt(currDate[2],10)){\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\telse if (parseInt(newDate[2],10) === parseInt(currDate[2],10)){\n\t\t\t\t\tif (parseInt(newDate[0],10) > parseInt(currDate[0],10)){\n\t\t\t\t\t\tflag = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (parseInt(newDate[0],10) === parseInt(currDate[0],10) && parseInt(newDate[1],10) > parseInt(currDate[1],10)){\n\t\t\t\t\t\tflag = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (flag){\n\t\t\t\t\tindex = j;\n\t\t\t\t\tcurrDate = list[j].stamp.split('/');\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (index !== i){\n\t\t\t\ttemp = list[i];\n\t\t\t\tlist[i] = list[index];\n\t\t\t\tlist[index] = temp;\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\n\trender(){\n\t\tconst {show, msg, messages, ctr, activeDocs, selectIndex} = this.state;\n\n\t\tlet msgs = [...messages]\n\n\t\tmsgs = this.sortDates(msgs);\n\n\t\tlet msgList = [];\n\n\t\tfor (let j = 0; j < (Math.min(msgs.length,ctr)); j++){\n\t\t\tif (msgs[j].status === 'accepted'){\n\t\t\t\tmsgList.push(\n\t\t\t\t\t<ListGroup key={j} horizontal>\n\t\t\t\t\t\t<ListGroup.Item className='pend list' action disabled>Peter Menikefs <span className={msgs[j].status}>{msgs[j].status}</span> your request for {this.entryIdToName(msgs[j].entryid)} {this.dateStyler(msgs[j].dates)}\n\t\t\t\t\t\t</ListGroup.Item>\n\t\t\t\t\t\t<ListGroup.Item className='edates list'>{msgs[j].stamp}</ListGroup.Item>\n\t\t\t\t\t</ListGroup>\n\t\t\t\t)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tmsgList.push(\n\t\t\t\t\t<ListGroup key={j} horizontal>\n\t\t\t\t\t\t<ListGroup.Item className='pend list' action onClick={() => this.toggleShow(msgs[j].msg)}>Peter Menikefs <span className={msgs[j].status}>{msgs[j].status}</span> your request for {this.entryIdToName(msgs[j].entryid)} {this.dateStyler(msgs[j].dates)}\n\t\t\t\t\t\t</ListGroup.Item>\n\t\t\t\t\t\t<ListGroup.Item className='edates list'>{msgs[j].stamp}</ListGroup.Item>\n\t\t\t\t\t</ListGroup>\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\n\n\t\tlet docSelect = activeDocs.map((doc,i) => {\n\t\t\treturn <option key={i} value={doc.lastname}>{doc.lastname}</option>\n\t\t})\n\n\t\tdocSelect.unshift(<option key={-1} value='All'>All</option>)\n\n\t\tlet adminSelect = () => {\n\t\t\treturn (\n\t\t\t\t<select value={activeDocs[selectIndex].lastname} onChange={this.onPhysicianChange} className=\"top-child doc selector\">\n  \t\t\t\t\t{docSelect}\n\t\t\t\t</select>\n\t\t\t);\n\t\t}\n\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t<div className='listStyleE'>\n\t\t\t\t\t{msgList}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t{this.showButton(messages.length)}\n\t\t\t\t</div>\n\t\t\t\t<div className='modal'>\n\t\t\t\t\t<Modal show={show} onHide={() => this.toggleShow('')}>\n\t\t\t\t\t\t<Modal.Header closeButton>\n\t\t\t\t\t\t\t<Modal.Title id='modalTitle'>Denied Request Explanation</Modal.Title>\n\t\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t\t<Modal.Body>\n\t\t\t\t\t\t\t<p>{msg}</p>\n\t\t\t\t\t\t</Modal.Body>\n\t\t\t\t\t\t<Modal.Footer>\n\t\t\t\t\t\t\t<Button onClick={() => this.toggleShow('')} variant=\"secondary\" >\n\t\t\t\t\t\t\t\tClose\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Modal.Footer>\n\t\t\t\t\t</Modal>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\n\t\t);\n\n\n\n\t}\n\n\n}\n\nexport default EMessages;"]},"metadata":{},"sourceType":"module"}